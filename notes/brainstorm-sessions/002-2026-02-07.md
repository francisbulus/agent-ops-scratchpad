# Session 002 - 2026-02-07

## Goal

- Define the simplest working AgentOps MVP that can be demoed end-to-end.

## MVP Definition (Walking Skeleton)

- One service can send agent run events (`started`, `completed`, `failed`) to an ingest API.
- Events are stored in one database table.
- Dashboard shows:
  - total runs (24h),
  - success rate (24h),
  - total estimated cost (24h),
  - latest failures list.
- Basic budget rule triggers an alert when daily cost crosses a threshold.

If these 4 things work with real data, we have a valid MVP.

## User Story (Day 1)

- As an operator, I can open one page and answer:
  - Are agents running?
  - Are they succeeding?
  - How much did we spend today?
  - What failed most recently?

## Minimum Build Scope

### Backend

- `POST /v1/events` endpoint in `services/ingest`.
- Input validation for required fields:
  - `timestamp`, `agent_id`, `workflow_id`, `status`, `latency_ms`, `cost_usd`.
- Persist to Postgres table `agent_events`.
- `GET /v1/metrics/overview` in `services/api` returning 24h aggregates.
- `GET /v1/failures/recent` returning latest failed runs.

### Frontend

- `apps/dashboard` single page with:
  - 4 KPI cards (runs, success rate, spend, avg latency),
  - one recent failures table,
  - simple "last updated" timestamp.

### Alerts

- Cron/worker checks daily spend every 5 minutes.
- If spend > configured budget threshold, send one Slack webhook message.

## Data Model (v0)

- `agent_events`
  - `id` (uuid pk)
  - `timestamp` (timestamptz)
  - `agent_id` (text)
  - `workflow_id` (text)
  - `status` (text: success|failure|started)
  - `latency_ms` (int)
  - `cost_usd` (numeric)
  - `error_type` (text nullable)
  - `trace_id` (text nullable)

## Non-Goals (Not MVP)

- Multi-provider billing reconciliation.
- Fine-grained RBAC.
- Policy simulation engine.
- Advanced anomaly detection.
- Complex tracing UI.

## Done Criteria

- Synthetic event generator can send 1,000 events and dashboard updates correctly.
- A forced failure appears in recent failures within 1 minute.
- Spend threshold test sends Slack alert once.
- Fresh deploy from README instructions works on a clean machine.

## 7-Day Plan

- Day 1: event schema + DB migration.
- Day 2: ingest endpoint + validation.
- Day 3: overview/failure query endpoints.
- Day 4: dashboard page connected to real API.
- Day 5: budget alert worker + Slack webhook.
- Day 6: synthetic load script + bug fixes.
- Day 7: polish, docs, demo script.

## Open Questions

- Keep as two Go services now, or collapse into one binary for speed?
- Is Slack the only required alert target for MVP?
- Do we need per-workspace filtering in MVP or global view only?

## Next Actions

- Freeze the v0 event schema in `packages`.
- Decide one DB migration tool and standardize it.
- Implement the first endpoint: `POST /v1/events`.
